import{a as Ce}from"./chunk-VHRQR5QR.js";import{a as Me,b as _e}from"./chunk-YPIGO5KQ.js";import{a as le,b as de,c as pe,d as se,f as fe}from"./chunk-3XDGEVN2.js";import{a as ve,b as ge}from"./chunk-YUH7H455.js";import{c as ue}from"./chunk-67IAFLRI.js";import{b as w,d as u,f as D,g as N,i as T,j as A,k as q,l as R,n as j,o as B,p as G,t as Z,u as ee}from"./chunk-SAZJTF6N.js";import{a as K,b as Q,d as W,g as X,h as Y}from"./chunk-IUCOVMK4.js";import{a as oe}from"./chunk-3YM7IDPM.js";import{a as ce}from"./chunk-WNOI4ZBI.js";import{a as re,b as me}from"./chunk-7SN2W6C3.js";import"./chunk-TMZC4RWW.js";import"./chunk-JKTBMZC7.js";import"./chunk-5KAHAUYY.js";import{A as z,B as L,C as H,E as U,F as $,G as J,R as te,S as ne,X as ie,Y as ae}from"./chunk-7UVTZ53J.js";import{$a as O,Aa as F,Fa as s,Qa as l,Ra as n,Rb as I,Sa as e,Sb as E,Ta as _,Vb as y,Y as g,Ya as x,Z as M,_a as C,cc as V,ec as k,jb as P,nb as i,ob as h,pb as S,sa as r,wa as p}from"./chunk-7SSOWWR7.js";function Se(a,m){if(a&1&&(n(0,"mat-option",24),i(1),e()),a&2){let o=m.$implicit;l("value",o.id),r(),S(" ",o.name," ")}}function be(a,m){a&1&&(n(0,"mat-error"),i(1," Vehicle is required. "),e())}function Fe(a,m){a&1&&(n(0,"mat-error"),i(1," Description is required. "),e())}function xe(a,m){a&1&&(n(0,"mat-error"),i(1," Date is required. "),e())}function Oe(a,m){a&1&&(n(0,"span"),i(1,"Cost is required"),e())}function Pe(a,m){a&1&&(n(0,"span"),i(1,"Cost must be positive"),e())}function Ie(a,m){if(a&1&&(n(0,"mat-error"),s(1,Oe,2,0,"span",10)(2,Pe,2,0,"span",10),e()),a&2){let o,t,c=O();r(),l("ngIf",(o=c.maintenanceForm.get("cost"))==null||o.errors==null?null:o.errors.required),r(),l("ngIf",(t=c.maintenanceForm.get("cost"))==null||t.errors==null?null:t.errors.min)}}var he=class a{constructor(m,o,t,c,d,f,v){this.fb=m;this.maintenanceService=o;this.vehicleService=t;this.route=c;this.router=d;this.popupService=f;this.dialog=v;this.maintenanceForm=this.fb.group({vehicle_id:["",u.required],description:["",u.required],date:["",u.required],cost:[0,[u.required,u.min(0)]],type:[""],is_completed:[!1]})}maintenanceForm;maintenanceId=null;vehicles=[];ngOnInit(){this.loadVehicles(),this.maintenanceId=this.route.snapshot.params.id||null,this.maintenanceId&&this.loadMaintenance(this.maintenanceId)}loadVehicles(){this.vehicleService.getVehicles().subscribe({next:m=>this.vehicles=m,error:()=>this.popupService.showError("Failed to load vehicles")})}loadMaintenance(m){this.maintenanceService.getMaintenances().subscribe({next:o=>{let t=o.find(c=>c.id===m);t?this.maintenanceForm.patchValue(t):this.popupService.showError("Maintenance not found")},error:()=>this.popupService.showError("Failed to load maintenance")})}onSubmit(){if(this.maintenanceForm.invalid)return;this.dialog.open(me,{data:{message:this.maintenanceId?"Are you sure you want to update this maintenance record?":"Are you sure you want to add this maintenance record?"}}).afterClosed().subscribe(o=>{if(o){let t=this.maintenanceForm.value;this.maintenanceId?this.maintenanceService.updateMaintenance(this.maintenanceId,t).subscribe({next:()=>{this.popupService.showSuccess("Maintenance updated successfully"),this.router.navigate(["/maintenance"])},error:()=>this.popupService.showError("Failed to update maintenance")}):this.maintenanceService.addMaintenance(t).subscribe({next:()=>{this.popupService.showSuccess("Maintenance added successfully"),this.router.navigate(["/maintenance"])},error:()=>this.popupService.showError("Failed to add maintenance")})}})}onCancel(){this.router.navigate(["/maintenance"])}static \u0275fac=function(o){return new(o||a)(p(B),p(Ce),p(ce),p(V),p(k),p(oe),p(re))};static \u0275cmp=F({type:a,selectors:[["app-maintenance-form"]],decls:65,vars:12,consts:[["datePicker",""],[1,"maintenance-form"],[1,"form-header"],["mat-stroked-button","",1,"back-btn",3,"click"],[1,"maintenance-form-content",3,"ngSubmit","formGroup"],[1,"form-row"],["appearance","outline",1,"form-group"],["id","vehicle_id","formControlName","vehicle_id"],["value",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["matInput","","id","description","formControlName","description","rows","4","placeholder","Enter maintenance description"],["matInput","","formControlName","date",3,"matDatepicker"],["matSuffix","",3,"for"],["matInput","","id","cost","type","number","formControlName","cost","placeholder","Enter cost","min","0","step","0.01"],["formControlName","type"],["value","preventive"],["value","corrective"],["value","emergency"],[1,"form-group","toggle-group"],["formControlName","is_completed"],[1,"form-actions"],["mat-stroked-button","","type","button",1,"cancel-btn",3,"click"],["mat-raised-button","","type","submit","color","primary",1,"submit-btn",3,"disabled"],[3,"value"]],template:function(o,t){if(o&1){let c=x();n(0,"mat-card",1)(1,"mat-card-header",2)(2,"mat-card-title"),i(3),e(),n(4,"mat-card-actions")(5,"button",3),C("click",function(){return g(c),M(t.onCancel())}),n(6,"mat-icon"),i(7,"arrow_back"),e(),i(8," Back to List "),e()()(),n(9,"mat-card-content")(10,"form",4),C("ngSubmit",function(){return g(c),M(t.onSubmit())}),n(11,"div",5)(12,"mat-form-field",6)(13,"mat-label"),i(14,"Vehicle *"),e(),n(15,"mat-select",7)(16,"mat-option",8),i(17,"Select Vehicle"),e(),s(18,Se,2,2,"mat-option",9),e(),s(19,be,2,0,"mat-error",10),e()(),n(20,"div",5)(21,"mat-form-field",6)(22,"mat-label"),i(23,"Description *"),e(),_(24,"textarea",11),s(25,Fe,2,0,"mat-error",10),e()(),n(26,"div",5)(27,"mat-form-field",6)(28,"mat-label"),i(29,"Maintenance Date *"),e(),_(30,"input",12)(31,"mat-datepicker-toggle",13)(32,"mat-datepicker",null,0),s(34,xe,2,0,"mat-error",10),e(),n(35,"mat-form-field",6)(36,"mat-label"),i(37,"Cost *"),e(),_(38,"input",14),s(39,Ie,3,2,"mat-error",10),e()(),n(40,"div",5)(41,"mat-form-field",6)(42,"mat-label"),i(43,"Maintenance Type"),e(),n(44,"mat-select",15)(45,"mat-option",8),i(46,"Select Type"),e(),n(47,"mat-option",16),i(48,"Preventive"),e(),n(49,"mat-option",17),i(50,"Corrective"),e(),n(51,"mat-option",18),i(52,"Emergency"),e()()(),n(53,"div",19)(54,"mat-label"),i(55,"Completed"),e(),n(56,"mat-slide-toggle",20),i(57,"Completed"),e()()(),n(58,"div",21)(59,"button",22),C("click",function(){return g(c),M(t.onCancel())}),i(60,"Cancel"),e(),n(61,"button",23)(62,"mat-icon"),i(63),e(),i(64),e()()()()()}if(o&2){let c,d,f,v,b=P(33);r(3),h(t.maintenanceId?"Edit Maintenance":"Add Maintenance"),r(7),l("formGroup",t.maintenanceForm),r(8),l("ngForOf",t.vehicles),r(),l("ngIf",((c=t.maintenanceForm.get("vehicle_id"))==null?null:c.invalid)&&((c=t.maintenanceForm.get("vehicle_id"))==null?null:c.touched)),r(6),l("ngIf",((d=t.maintenanceForm.get("description"))==null?null:d.invalid)&&((d=t.maintenanceForm.get("description"))==null?null:d.touched)),r(5),l("matDatepicker",b),r(),l("for",b),r(3),l("ngIf",((f=t.maintenanceForm.get("date"))==null?null:f.invalid)&&((f=t.maintenanceForm.get("date"))==null?null:f.touched)),r(5),l("ngIf",((v=t.maintenanceForm.get("cost"))==null?null:v.invalid)&&((v=t.maintenanceForm.get("cost"))==null?null:v.touched)),r(22),l("disabled",t.maintenanceForm.invalid),r(2),h(t.maintenanceId?"save":"add"),r(),S(" ",t.maintenanceId?"Update":"Add"," Maintenance ")}},dependencies:[y,I,E,G,T,w,A,D,N,j,q,R,J,z,U,H,$,L,Y,X,K,Q,W,ee,Z,ge,ve,ue,ae,ie,ne,te,se,le,de,pe,fe,_e,Me],styles:[".maintenance-form[_ngcontent-%COMP%]{max-width:600px;margin:0 auto;padding:20px}.maintenance-form[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:15px}.maintenance-form[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;flex-direction:column}.maintenance-form[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:5px;font-weight:700}.maintenance-form[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .maintenance-form[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .maintenance-form[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{padding:8px;border:1px solid #ccc;border-radius:4px}.maintenance-form[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:vertical;min-height:80px}.maintenance-form[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:red;font-size:.9em;margin-top:5px}.maintenance-form[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px;background-color:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer}.maintenance-form[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}"]})};export{he as MaintenanceFormComponent};
