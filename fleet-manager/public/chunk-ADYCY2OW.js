import{a as ne,b as oe}from"./chunk-YUH7H455.js";import{c as te}from"./chunk-67IAFLRI.js";import{b as M,d as f,f as D,g as N,i as y,j as O,k as V,l as k,n as w,o as P,p as T,t as U,u as Y}from"./chunk-SAZJTF6N.js";import{a as q,b as $,g as z,h as H}from"./chunk-IUCOVMK4.js";import{a as Z,b as ee}from"./chunk-FFLQZGHZ.js";import{a as X}from"./chunk-3YM7IDPM.js";import{a as re}from"./chunk-WNOI4ZBI.js";import{a as ie}from"./chunk-F4ZXE7SN.js";import"./chunk-TMZC4RWW.js";import"./chunk-JKTBMZC7.js";import"./chunk-5KAHAUYY.js";import{A,B as R,C as j,E as B,F as G,G as L,R as J,S as K,X as Q,Y as W}from"./chunk-7UVTZ53J.js";import{$a as b,Aa as _,Fa as s,Qa as d,Ra as i,Rb as F,Sa as e,Sb as C,Ta as c,Vb as x,_a as v,cc as E,ec as I,nb as a,ob as h,pb as g,qb as S,sa as m,wa as p}from"./chunk-7SSOWWR7.js";function me(t,n){t&1&&(i(0,"mat-error"),a(1," Driver name is required "),e())}function le(t,n){t&1&&(i(0,"span"),a(1,"Experience must be at least 0"),e())}function de(t,n){t&1&&(i(0,"span"),a(1,"Experience must be a positive integer"),e())}function pe(t,n){if(t&1&&(i(0,"mat-error"),s(1,le,2,0,"span",7)(2,de,2,0,"span",7),e()),t&2){let o,r,l=b();m(),d("ngIf",(o=l.driverForm.get("numberOfExperience"))==null||o.errors==null?null:o.errors.min),m(),d("ngIf",(r=l.driverForm.get("numberOfExperience"))==null||r.errors==null?null:r.errors.pattern)}}function ce(t,n){if(t&1&&(i(0,"mat-option",19),a(1),e()),t&2){let o=n.$implicit;d("value",o.id),m(),S(" ",o.name," - ",o.registrationNumber," ")}}function se(t,n){t&1&&c(0,"mat-spinner",20)}function ue(t,n){if(t&1&&(i(0,"mat-icon"),a(1),e()),t&2){let o=b();m(),h(o.driverId?"save":"person_add")}}var ae=class t{constructor(n,o,r,l,u,ve){this.fb=n;this.driverService=o;this.vehicleService=r;this.route=l;this.router=u;this.popupService=ve;this.driverForm=this.fb.group({name:["",f.required],vehicle_id:[""],numberOfExperience:[0,[f.min(0),f.pattern(/^\d+$/)]],licenseNumber:[""],contactInfo:[""]})}driverForm;driverId=null;vehicles=[];loading=!1;ngOnInit(){this.driverId=this.route.snapshot.params.id||null,this.loadVehicles(),this.driverId&&this.loadDriver(this.driverId)}loadVehicles(){this.vehicleService.getVehicles().subscribe({next:n=>this.vehicles=n,error:()=>this.popupService.showError("Failed to load vehicles")})}loadDriver(n){this.driverService.getDrivers().subscribe({next:o=>{let r=o.find(l=>l.id===n);r?this.driverForm.patchValue(r):this.popupService.showError("Driver not found")},error:()=>this.popupService.showError("Failed to load driver")})}onSubmit(){if(this.driverForm.invalid)return;this.loading=!0;let n=this.driverForm.value;this.driverId?this.driverService.updateDriver(this.driverId,n).subscribe({next:()=>{this.popupService.showSuccess("Driver updated successfully"),this.router.navigate(["/drivers"])},error:()=>{this.popupService.showError("Failed to update driver"),this.loading=!1}}):this.driverService.addDriver(n).subscribe({next:()=>{this.popupService.showSuccess("Driver added successfully"),this.router.navigate(["/drivers"])},error:()=>{this.popupService.showError("Failed to add driver"),this.loading=!1}})}onCancel(){this.router.navigate(["/drivers"])}static \u0275fac=function(o){return new(o||t)(p(P),p(ie),p(re),p(E),p(I),p(X))};static \u0275cmp=_({type:t,selectors:[["app-driver-form"]],decls:47,vars:9,consts:[[1,"driver-form"],[1,"form-header"],["mat-stroked-button","",1,"back-btn",3,"click"],[1,"driver-form-content",3,"ngSubmit","formGroup"],[1,"form-row"],["appearance","outline",1,"form-group"],["matInput","","id","name","formControlName","name","placeholder","Enter driver name"],[4,"ngIf"],["matInput","","id","licenseNumber","formControlName","licenseNumber","placeholder","Enter license number"],["matInput","","id","contactInfo","formControlName","contactInfo","placeholder","Enter contact information"],["matInput","","type","number","id","numberOfExperience","formControlName","numberOfExperience","placeholder","Enter years of experience","min","0"],["id","vehicle","formControlName","vehicle_id"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-group"],[1,"form-actions"],["mat-stroked-button","","type","button",1,"cancel-btn",3,"click"],["mat-raised-button","","type","submit","color","primary",1,"submit-btn",3,"disabled"],["diameter","20",4,"ngIf"],[3,"value"],["diameter","20"]],template:function(o,r){if(o&1&&(i(0,"mat-card",0)(1,"mat-card-header",1)(2,"mat-card-title"),a(3),e(),i(4,"mat-card-actions")(5,"button",2),v("click",function(){return r.onCancel()}),i(6,"mat-icon"),a(7,"arrow_back"),e(),a(8," Back to List "),e()()(),i(9,"mat-card-content")(10,"form",3),v("ngSubmit",function(){return r.onSubmit()}),i(11,"div",4)(12,"mat-form-field",5)(13,"mat-label"),a(14,"Driver Name *"),e(),c(15,"input",6),s(16,me,2,0,"mat-error",7),e(),i(17,"mat-form-field",5)(18,"mat-label"),a(19,"License Number"),e(),c(20,"input",8),e()(),i(21,"div",4)(22,"mat-form-field",5)(23,"mat-label"),a(24,"Contact Info"),e(),c(25,"input",9),e(),i(26,"mat-form-field",5)(27,"mat-label"),a(28,"Years of Experience"),e(),c(29,"input",10),s(30,pe,3,2,"mat-error",7),e()(),i(31,"div",4)(32,"mat-form-field",5)(33,"mat-label"),a(34,"Assign Vehicle"),e(),i(35,"mat-select",11)(36,"mat-option",12),a(37,"None"),e(),s(38,ce,2,3,"mat-option",13),e()(),c(39,"div",14),e(),i(40,"div",15)(41,"button",16),v("click",function(){return r.onCancel()}),a(42,"Cancel"),e(),i(43,"button",17),s(44,se,1,0,"mat-spinner",18)(45,ue,2,1,"mat-icon",7),a(46),e()()()()()),o&2){let l,u;m(3),h(r.driverId?"Edit Driver":"Add New Driver"),m(7),d("formGroup",r.driverForm),m(6),d("ngIf",((l=r.driverForm.get("name"))==null?null:l.invalid)&&((l=r.driverForm.get("name"))==null?null:l.touched)),m(14),d("ngIf",((u=r.driverForm.get("numberOfExperience"))==null?null:u.invalid)&&((u=r.driverForm.get("numberOfExperience"))==null?null:u.touched)),m(8),d("ngForOf",r.vehicles),m(5),d("disabled",r.loading||r.driverForm.invalid),m(),d("ngIf",r.loading),m(),d("ngIf",!r.loading),m(),g(" ",r.driverId?"Update":"Add"," Driver ")}},dependencies:[x,F,C,T,y,M,O,D,N,w,V,k,L,A,B,j,G,R,H,z,q,$,Y,U,oe,ne,te,W,Q,K,J,ee,Z],styles:[".driver-form[_ngcontent-%COMP%]{max-width:400px;margin:20px auto}.error[_ngcontent-%COMP%]{color:red}label[_ngcontent-%COMP%]{display:block;margin-bottom:5px}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{width:100%;padding:8px;box-sizing:border-box;margin-bottom:10px}button[_ngcontent-%COMP%]{padding:10px 20px;background-color:#007bff;color:#fff;border:none;border-radius:5px;cursor:pointer}button[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}"]})};export{ae as DriverFormComponent};
