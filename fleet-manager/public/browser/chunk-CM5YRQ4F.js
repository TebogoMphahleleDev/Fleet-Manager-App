import{a as Fe,b as Ee}from"./chunk-YPIGO5KQ.js";import{a as ce,b as ue,c as se,d as fe,f as _e}from"./chunk-3XDGEVN2.js";import{a as he,b as Se}from"./chunk-YUH7H455.js";import{c as ve}from"./chunk-67IAFLRI.js";import{b as q,d as v,f as A,g as R,i as $,k as j,l as B,o as G,p as L,t as te,u as ie}from"./chunk-SAZJTF6N.js";import{a as W,b as X,d as Y,g as Z,h as ee}from"./chunk-IUCOVMK4.js";import{a as me}from"./chunk-3YM7IDPM.js";import{a as de}from"./chunk-WNOI4ZBI.js";import{a as ge}from"./chunk-F4ZXE7SN.js";import{a as be}from"./chunk-6RIRNLKB.js";import{a as le,b as pe}from"./chunk-7SN2W6C3.js";import"./chunk-TMZC4RWW.js";import"./chunk-JKTBMZC7.js";import"./chunk-5KAHAUYY.js";import{A as H,B as z,C as U,E as J,F as K,G as Q,R as re,S as oe,X as ne,Y as ae}from"./chunk-7UVTZ53J.js";import{Aa as D,Fa as d,Qa as l,Ra as t,Rb as V,Sa as e,Sb as w,Ta as h,Vb as N,Y as b,Ya as k,Z as F,_a as E,a as x,b as y,cc as O,ec as P,jb as T,nb as r,ob as f,pb as C,sa as m,wa as s}from"./chunk-7SSOWWR7.js";function Te(o,a){if(o&1&&(t(0,"mat-option",36),r(1),e()),o&2){let n=a.$implicit;l("value",n.id),m(),C(" ",n.name," ")}}function Me(o,a){o&1&&(t(0,"mat-error"),r(1," Driver is required. "),e())}function Ie(o,a){if(o&1&&(t(0,"mat-option",36),r(1),e()),o&2){let n=a.$implicit;l("value",n.id),m(),C(" ",n.name," ")}}function xe(o,a){o&1&&(t(0,"mat-error"),r(1," Vehicle is required. "),e())}function ye(o,a){o&1&&(t(0,"mat-error"),r(1," Start location is required. "),e())}function De(o,a){o&1&&(t(0,"mat-error"),r(1," End location is required. "),e())}function ke(o,a){o&1&&(t(0,"mat-error"),r(1," Start date is required. "),e())}function Ve(o,a){if(o&1&&(t(0,"mat-option",36),r(1),e()),o&2){let n=a.$implicit;l("value",n),m(),f(n)}}function we(o,a){if(o&1&&(t(0,"mat-option",36),r(1),e()),o&2){let n=a.$implicit;l("value",n),m(),f(n)}}function Ne(o,a){o&1&&(t(0,"mat-error"),r(1," End date is required. "),e())}function Oe(o,a){if(o&1&&(t(0,"mat-option",36),r(1),e()),o&2){let n=a.$implicit;l("value",n),m(),f(n)}}function Pe(o,a){if(o&1&&(t(0,"mat-option",36),r(1),e()),o&2){let n=a.$implicit;l("value",n),m(),f(n)}}var Ce=class o{constructor(a,n,i,p,c,u,_,g){this.fb=a;this.tripService=n;this.driverService=i;this.vehicleService=p;this.route=c;this.router=u;this.popupService=_;this.dialog=g;this.tripForm=this.fb.group({driver_id:["",v.required],vehicle_id:["",v.required],start_location:["",v.required],end_location:["",v.required],start_date:["",v.required],start_hour:[""],start_minute:[""],end_date:["",v.required],end_hour:[""],end_minute:[""],status:["planned"],is_round_trip:[!1]})}tripForm;tripId=null;drivers=[];vehicles=[];hours=[];minutes=[];ngOnInit(){this.hours=Array.from({length:24},(a,n)=>n.toString().padStart(2,"0")),this.minutes=Array.from({length:60},(a,n)=>n.toString().padStart(2,"0")),this.loadDrivers(),this.loadVehicles(),this.tripId=this.route.snapshot.params.id||null,this.tripId&&this.loadTrip(this.tripId)}loadDrivers(){this.driverService.getDrivers().subscribe({next:a=>this.drivers=a,error:()=>this.popupService.showError("Failed to load drivers")})}loadVehicles(){this.vehicleService.getVehicles().subscribe({next:a=>this.vehicles=a,error:()=>this.popupService.showError("Failed to load vehicles")})}loadTrip(a){this.tripService.getTrips().subscribe({next:n=>{let i=n.find(p=>p.id===a);i?this.tripForm.patchValue(i):this.popupService.showError("Trip not found")},error:()=>this.popupService.showError("Failed to load trip")})}onSubmit(){if(console.log("Form valid:",this.tripForm.valid),this.tripForm.invalid)return;this.dialog.open(pe,{data:{message:this.tripId?"Are you sure you want to update this trip?":"Are you sure you want to add this trip?"}}).afterClosed().subscribe(n=>{if(n){let i=this.tripForm.value,p=i.start_hour&&i.start_minute?`${i.start_hour}:${i.start_minute}`:void 0,c=i.end_hour&&i.end_minute?`${i.end_hour}:${i.end_minute}`:void 0,u=y(x({},i),{start_time:p,end_time:c});console.log("Submitting trip data:",u),this.tripId?this.tripService.updateTrip(this.tripId,u).subscribe({next:()=>{this.popupService.showSuccess("Trip updated successfully"),this.router.navigate(["/trips"])},error:()=>this.popupService.showError("Failed to update trip")}):this.tripService.addTrip(u).subscribe({next:()=>{this.popupService.showSuccess("Trip added successfully"),this.router.navigate(["/trips"])},error:()=>this.popupService.showError("Failed to add trip")})}})}onCancel(){this.router.navigate(["/trips"])}static \u0275fac=function(n){return new(n||o)(s(G),s(be),s(ge),s(de),s(O),s(P),s(me),s(le))};static \u0275cmp=D({type:o,selectors:[["app-trip-form"]],decls:105,vars:21,consts:[["startPicker",""],["endPicker",""],[1,"trip-form"],[1,"form-header"],["mat-stroked-button","",1,"back-btn",3,"click"],[1,"trip-form-content",3,"ngSubmit","formGroup"],[1,"form-row"],["appearance","outline",1,"form-group"],["id","driver_id","formControlName","driver_id"],["value",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["id","vehicle_id","formControlName","vehicle_id"],["matInput","","id","start_location","formControlName","start_location","placeholder","Enter start location"],["matInput","","id","end_location","formControlName","end_location","placeholder","Enter end location"],[1,"datetime-group"],["appearance","outline",1,"form-group","date-field"],["matInput","","formControlName","start_date",3,"matDatepicker"],["matSuffix","",3,"for"],[1,"time-group"],["appearance","outline",1,"form-group","time-field"],["formControlName","start_hour"],["formControlName","start_minute"],["matInput","","formControlName","end_date",3,"matDatepicker"],["formControlName","end_hour"],["formControlName","end_minute"],["formControlName","status"],["value","planned"],["value","in_progress"],["value","completed"],["value","cancelled"],[1,"form-group","toggle-group"],["formControlName","is_round_trip"],[1,"form-actions"],["mat-stroked-button","","type","button",1,"cancel-btn",3,"click"],["mat-raised-button","","type","submit","color","primary",1,"submit-btn",3,"disabled"],[3,"value"]],template:function(n,i){if(n&1){let p=k();t(0,"mat-card",2)(1,"mat-card-header",3)(2,"mat-card-title"),r(3),e(),t(4,"mat-card-actions")(5,"button",4),E("click",function(){return b(p),F(i.onCancel())}),t(6,"mat-icon"),r(7,"arrow_back"),e(),r(8," Back to List "),e()()(),t(9,"mat-card-content")(10,"form",5),E("ngSubmit",function(){return b(p),F(i.onSubmit())}),t(11,"div",6)(12,"mat-form-field",7)(13,"mat-label"),r(14,"Driver *"),e(),t(15,"mat-select",8)(16,"mat-option",9),r(17,"Select Driver"),e(),d(18,Te,2,2,"mat-option",10),e(),d(19,Me,2,0,"mat-error",11),e(),t(20,"mat-form-field",7)(21,"mat-label"),r(22,"Vehicle *"),e(),t(23,"mat-select",12)(24,"mat-option",9),r(25,"Select Vehicle"),e(),d(26,Ie,2,2,"mat-option",10),e(),d(27,xe,2,0,"mat-error",11),e()(),t(28,"div",6)(29,"mat-form-field",7)(30,"mat-label"),r(31,"Start Location *"),e(),h(32,"input",13),d(33,ye,2,0,"mat-error",11),e(),t(34,"mat-form-field",7)(35,"mat-label"),r(36,"End Location *"),e(),h(37,"input",14),d(38,De,2,0,"mat-error",11),e()(),t(39,"div",6)(40,"div",15)(41,"mat-form-field",16)(42,"mat-label"),r(43,"Start Date *"),e(),h(44,"input",17)(45,"mat-datepicker-toggle",18)(46,"mat-datepicker",null,0),d(48,ke,2,0,"mat-error",11),e(),t(49,"div",19)(50,"mat-form-field",20)(51,"mat-label"),r(52,"Start Hour"),e(),t(53,"mat-select",21),d(54,Ve,2,2,"mat-option",10),e()(),t(55,"mat-form-field",20)(56,"mat-label"),r(57,"Start Minute"),e(),t(58,"mat-select",22),d(59,we,2,2,"mat-option",10),e()()()(),t(60,"div",15)(61,"mat-form-field",16)(62,"mat-label"),r(63,"End Date *"),e(),h(64,"input",23)(65,"mat-datepicker-toggle",18)(66,"mat-datepicker",null,1),d(68,Ne,2,0,"mat-error",11),e(),t(69,"div",19)(70,"mat-form-field",20)(71,"mat-label"),r(72,"End Hour"),e(),t(73,"mat-select",24),d(74,Oe,2,2,"mat-option",10),e()(),t(75,"mat-form-field",20)(76,"mat-label"),r(77,"End Minute"),e(),t(78,"mat-select",25),d(79,Pe,2,2,"mat-option",10),e()()()()(),t(80,"div",6)(81,"mat-form-field",7)(82,"mat-label"),r(83,"Trip Status"),e(),t(84,"mat-select",26)(85,"mat-option",27),r(86,"Planned"),e(),t(87,"mat-option",28),r(88,"In Progress"),e(),t(89,"mat-option",29),r(90,"Completed"),e(),t(91,"mat-option",30),r(92,"Cancelled"),e()()(),t(93,"div",31)(94,"mat-label"),r(95,"Round Trip"),e(),t(96,"mat-slide-toggle",32),r(97,"Round Trip"),e()()(),t(98,"div",33)(99,"button",34),E("click",function(){return b(p),F(i.onCancel())}),r(100,"Cancel"),e(),t(101,"button",35)(102,"mat-icon"),r(103),e(),r(104),e()()()()()}if(n&2){let p,c,u,_,g,S,M=T(47),I=T(67);m(3),f(i.tripId?"Edit Trip":"Add Trip"),m(7),l("formGroup",i.tripForm),m(8),l("ngForOf",i.drivers),m(),l("ngIf",((p=i.tripForm.get("driver_id"))==null?null:p.invalid)&&((p=i.tripForm.get("driver_id"))==null?null:p.touched)),m(7),l("ngForOf",i.vehicles),m(),l("ngIf",((c=i.tripForm.get("vehicle_id"))==null?null:c.invalid)&&((c=i.tripForm.get("vehicle_id"))==null?null:c.touched)),m(6),l("ngIf",((u=i.tripForm.get("start_location"))==null?null:u.invalid)&&((u=i.tripForm.get("start_location"))==null?null:u.touched)),m(5),l("ngIf",((_=i.tripForm.get("end_location"))==null?null:_.invalid)&&((_=i.tripForm.get("end_location"))==null?null:_.touched)),m(6),l("matDatepicker",M),m(),l("for",M),m(3),l("ngIf",((g=i.tripForm.get("start_date"))==null?null:g.invalid)&&((g=i.tripForm.get("start_date"))==null?null:g.touched)),m(6),l("ngForOf",i.hours),m(5),l("ngForOf",i.minutes),m(5),l("matDatepicker",I),m(),l("for",I),m(3),l("ngIf",((S=i.tripForm.get("end_date"))==null?null:S.invalid)&&((S=i.tripForm.get("end_date"))==null?null:S.touched)),m(6),l("ngForOf",i.hours),m(5),l("ngForOf",i.minutes),m(22),l("disabled",i.tripForm.invalid),m(2),f(i.tripId?"save":"add"),m(),C(" ",i.tripId?"Update":"Add"," Trip ")}},dependencies:[N,V,w,L,$,q,A,R,j,B,Q,H,J,U,K,z,ee,Z,W,X,Y,ie,te,Se,he,ve,ae,ne,oe,re,fe,ce,ue,se,_e,Ee,Fe],styles:[".trip-form[_ngcontent-%COMP%]{padding:20px}form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin:10px 0}label[_ngcontent-%COMP%]{display:block;margin-bottom:5px}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{width:100%;padding:8px;box-sizing:border-box}.error[_ngcontent-%COMP%]{color:red;font-size:.9em}button[_ngcontent-%COMP%]{padding:10px 20px;background-color:#007bff;color:#fff;border:none;cursor:pointer}button[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}"]})};export{Ce as TripFormComponent};
